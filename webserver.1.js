var j=t=>{throw TypeError(t)};var A=(t,e,r)=>e.has(t)||j("Cannot "+r);var s=(t,e,r)=>(A(t,e,"read from private field"),r?r.call(t):e.get(t)),f=(t,e,r)=>e.has(t)?j("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),a=(t,e,r,n)=>(A(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),G=(t,e,r)=>(A(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const J=String.raw,Z=J`
<div id="app">
  <div class="container">
    <input type="range" id="brightness-slider" min="0.0" max="1.0" value="0.5" step="0.004" disabled>
    <div class="value">Brightness: <span id="brightness-label"></span></div>
  </div>
  <div class="container">
    <input type="range" id="temperature-slider" min="0.0" max="1.0" value="0.5" step="0.004" disabled>
    <div class="value">Temperature: <span id="temperature-label"></span></div>
    <button id="power-button" disabled>Turn On</button>
  </div>
  <div class="container">
    <canvas id="color-wheel" width="300" height="300"></canvas>
    <div id="color-display">RGB: (1.00, 0.00, 0.00)</div>
  </div>
</div>
`;document.body.innerHTML=Z;const k=500,W="";function L(t){if(!Number.isInteger(t))return null;const e=new ArrayBuffer(4);return new DataView(e).setUint32(0,t,!0),new DataView(e).getFloat32(0,!0)}function v(t,e,r){return Math.min(Math.max(t,e),r)}function ee(t,e){if(!t)throw new Error(e)}var B,M,d,I,g,w,x,D,S,K;const Y=class Y{constructor(e){f(this,S);f(this,B);f(this,M);f(this,d);f(this,I);f(this,g);f(this,w);f(this,x);f(this,D);var r,n,o;a(this,B,e.state??!1),a(this,d,{r:L((r=e.color)==null?void 0:r.r)??1,g:L((n=e.color)==null?void 0:n.g)??1,b:L((o=e.color)==null?void 0:o.b)??1}),a(this,I,L(e.brightness)??1),a(this,g,e.color_mode??"color_temp"),a(this,w,L(e.min_color_temp)??0),a(this,x,L(e.max_color_temp)??0),a(this,M,L(e.color_temp)??(s(this,w)+s(this,x))/2),ee(s(this,w)<=s(this,x),"Min color temperature must be less than or equal to max color temperature"),a(this,D,null)}get state(){return s(this,B)}set state(e){a(this,B,!!e)}get color_temp(){return s(this,M)}set color_temp(e){a(this,M,v(e,s(this,w),s(this,x))),a(this,g,"color_temp")}get red(){return s(this,d).r}set red(e){s(this,d).r=v(e,0,1),a(this,g,"rgb")}get green(){return s(this,d).g}set green(e){s(this,d).g=v(e,0,1),a(this,g,"rgb")}get blue(){return s(this,d).b}set blue(e){s(this,d).b=v(e,0,1),a(this,g,"rgb")}setColor(e,r,n){s(this,d).r=v(e,0,1),s(this,d).g=v(r,0,1),s(this,d).b=v(n,0,1),a(this,g,"rgb")}get brightness(){return s(this,I)}set brightness(e){a(this,I,v(e,0,1))}get color_mode(){return s(this,g)}set color_mode(e){e==="color_temp"||e==="rgb"?a(this,g,e):console.log("Unknown color mode:",e)}get min_color_temp(){return s(this,w)}get max_color_temp(){return s(this,x)}static async fetch(){const r=await(await fetch(`${W}/light/rgbcct_bulb/dump`)).json();return new Y(r)}async debounce(){clearTimeout(s(this,D)),a(this,D,setTimeout(()=>{G(this,S,K).call(this)},k))}};B=new WeakMap,M=new WeakMap,d=new WeakMap,I=new WeakMap,g=new WeakMap,w=new WeakMap,x=new WeakMap,D=new WeakMap,S=new WeakSet,K=async function(){if(!s(this,B)){try{await fetch(`${W}/light/rgbcct_bulb/turn_off`,{method:"POST"}),console.log("Light state:",this)}catch(n){console.error("Failed to update light state:",n)}return}const e={};e.brightness=s(this,I)*255,s(this,g)==="color_temp"?e.color_temp=s(this,M):s(this,g)==="rgb"&&(e.r=s(this,d).r*255,e.g=s(this,d).g*255,e.b=s(this,d).b*255);const r=new URLSearchParams(e).toString();console.log("Query string:",r);try{await fetch(`${W}/light/rgbcct_bulb/turn_on?`+r,{method:"POST"}),console.log("Light state:",this)}catch(n){console.error("Failed to update light state:",n)}};let V=Y,l;const T={slider:document.getElementById("brightness-slider"),label:document.getElementById("brightness-label")},O={slider:document.getElementById("temperature-slider"),label:document.getElementById("temperature-label")},q=document.getElementById("power-button");T.slider.disabled=!0;O.slider.disabled=!0;q.disabled=!0;const y=document.getElementById("color-wheel"),C=y.getContext("2d"),te=document.getElementById("color-display"),_=300,h=_/2;y.width=y.height=_;y.style.width=y.style.height=_+"px";let R=null,X=null;function z(t,e,r){let n=(t*180/Math.PI%360+360)%360,o=e,i=r,c=i*o,m=c*(1-Math.abs(n/60%2-1)),E=i-c,p,b,u;n<60?(p=c,b=m,u=0):n<120?(p=m,b=c,u=0):n<180?(p=0,b=c,u=m):n<240?(p=0,b=m,u=c):n<300?(p=m,b=0,u=c):(p=c,b=0,u=m);const N=p+E,P=b+E,U=u+E;return{r:N,g:P,b:U}}function re(){const t=C.getImageData(0,0,_,_),e=t.data;for(let r=0;r<_;r++)for(let n=0;n<_;n++){const o=n-h,i=r-h,c=Math.sqrt(o*o+i*i);if(c<=h){const m=Math.atan2(i,o),{r:E,g:p,b}=z(m,c/h,X),u=(r*_+n)*4;e[u]=E*255,e[u+1]=p*255,e[u+2]=b*255,e[u+3]=255}}C.putImageData(t,0,0)}let H=0,$=!1;function F(t=!1){T.slider.disabled=!l.state,T.slider.value=l.brightness,T.label.textContent=(l.brightness*100).toFixed(2),O.slider.disabled=!l.state,O.slider.value=1-(l.color_temp-l.min_color_temp)/(l.max_color_temp-l.min_color_temp),O.label.textContent=(1e6/l.color_temp).toFixed(2)+"K",q.textContent=l.state?"Turn Off":"Turn On";const e=l.state;if(R!==e||R&&X!==l.brightness){R=e,X=l.brightness;const r=performance.now();!$&&r-H>=60&&($=!0,requestAnimationFrame(()=>{C.clearRect(0,0,_,_),R?(y.style.pointerEvents="auto",re()):(C.fillStyle="rgba(100, 100, 100, 0.5)",C.beginPath(),C.arc(h,h,h,0,2*Math.PI),C.fill()),H=performance.now(),$=!1}))}t||l.debounce()}T.slider.addEventListener("input",()=>{l.brightness=T.slider.value,F()});O.slider.addEventListener("input",()=>{l.color_temp=l.min_color_temp+(1-O.slider.value)*(l.max_color_temp-l.min_color_temp),F()});q.addEventListener("click",()=>{l.state=!l.state,F()});y.addEventListener("pointerdown",t=>{{const o=y.getBoundingClientRect();let i=t.clientX-o.left-h,c=t.clientY-o.top-h;if(Math.sqrt(i*i+c*c)>h)return}const e=o=>{const i=y.getBoundingClientRect();let c=o.clientX-i.left-h,m=o.clientY-i.top-h;const E=Math.min(Math.sqrt(c*c+m*m),h),p=Math.atan2(m,c),{r:b,g:u,b:N}=z(p,E/h,1),P=[b,u,N],U=`RGB: (${P.map(Q=>Q.toFixed(2)).join(", ")})`;te.textContent=U,l.setColor(P[0],P[1],P[2]),F()},r=o=>{o.preventDefault(),e(o)},n=()=>{document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",n)};document.addEventListener("pointermove",r),document.addEventListener("pointerup",n),e(t)});V.fetch().then(t=>{l=t,q.disabled=!1,F(!0)});
