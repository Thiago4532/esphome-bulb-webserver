var Y=e=>{throw TypeError(e)};var W=(e,t,o)=>t.has(e)||Y("Cannot "+o);var s=(e,t,o)=>(W(e,t,"read from private field"),o?o.call(e):t.get(e)),f=(e,t,o)=>t.has(e)?Y("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,o),a=(e,t,o,n)=>(W(e,t,"write to private field"),n?n.call(e,o):t.set(e,o),o),j=(e,t,o)=>(W(e,t,"access private method"),o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}})();const z=String.raw,Q=z`
<div id="app">
  <div class="container">
    <input type="range" id="brightness-slider" min="0.0" max="1.0" value="0.5" step="0.004" disabled>
    <div class="value">Brightness: <span id="brightness-label"></span></div>
  </div>
  <div class="container">
    <input type="range" id="temperature-slider" min="0.0" max="1.0" value="0.5" step="0.004" disabled>
    <div class="value">Temperature: <span id="temperature-label"></span></div>
    <button id="power-button" disabled>Turn On</button>
  </div>
  <div class="container">
    <canvas id="color-wheel" width="300" height="300"></canvas>
    <div id="color-display">RGB: (1.00, 0.00, 0.00)</div>
  </div>
</div>
`;document.body.innerHTML=Q;const J=500,A="";function L(e){if(!Number.isInteger(e))return null;const t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e,!0),new DataView(t).getFloat32(0,!0)}function y(e,t,o){return Math.min(Math.max(e,t),o)}function Z(e,t){if(!e)throw new Error(t)}var B,M,d,I,g,w,x,D,F,G;const X=class X{constructor(t){f(this,F);f(this,B);f(this,M);f(this,d);f(this,I);f(this,g);f(this,w);f(this,x);f(this,D);var o,n,r;a(this,B,t.state??!1),a(this,d,{r:L((o=t.color)==null?void 0:o.r)??1,g:L((n=t.color)==null?void 0:n.g)??1,b:L((r=t.color)==null?void 0:r.b)??1}),a(this,I,L(t.brightness)??1),a(this,g,t.color_mode??"color_temp"),a(this,w,L(t.min_color_temp)??0),a(this,x,L(t.max_color_temp)??0),a(this,M,L(t.color_temp)??(s(this,w)+s(this,x))/2),Z(s(this,w)<=s(this,x),"Min color temperature must be less than or equal to max color temperature"),a(this,D,null)}get state(){return s(this,B)}set state(t){a(this,B,!!t)}get color_temp(){return s(this,M)}set color_temp(t){a(this,M,y(t,s(this,w),s(this,x))),a(this,g,"color_temp")}get red(){return s(this,d).r}set red(t){s(this,d).r=y(t,0,1),a(this,g,"rgb")}get green(){return s(this,d).g}set green(t){s(this,d).g=y(t,0,1),a(this,g,"rgb")}get blue(){return s(this,d).b}set blue(t){s(this,d).b=y(t,0,1),a(this,g,"rgb")}setColor(t,o,n){s(this,d).r=y(t,0,1),s(this,d).g=y(o,0,1),s(this,d).b=y(n,0,1),a(this,g,"rgb")}get brightness(){return s(this,I)}set brightness(t){a(this,I,y(t,0,1))}get color_mode(){return s(this,g)}set color_mode(t){t==="color_temp"||t==="rgb"?a(this,g,t):console.log("Unknown color mode:",t)}get min_color_temp(){return s(this,w)}get max_color_temp(){return s(this,x)}static async fetch(){const o=await(await fetch(`${A}/light/rgbcct_bulb/dump`)).json();return new X(o)}async debounce(){clearTimeout(s(this,D)),a(this,D,setTimeout(()=>{j(this,F,G).call(this)},J))}};B=new WeakMap,M=new WeakMap,d=new WeakMap,I=new WeakMap,g=new WeakMap,w=new WeakMap,x=new WeakMap,D=new WeakMap,F=new WeakSet,G=async function(){if(!s(this,B)){try{await fetch(`${A}/light/rgbcct_bulb/turn_off`,{method:"POST"}),console.log("Light state:",this)}catch(n){console.error("Failed to update light state:",n)}return}const t={};t.brightness=s(this,I)*255,s(this,g)==="color_temp"?t.color_temp=s(this,M):s(this,g)==="rgb"&&(t.r=s(this,d).r*255,t.g=s(this,d).g*255,t.b=s(this,d).b*255);const o=new URLSearchParams(t).toString();console.log("Query string:",o);try{await fetch(`${A}/light/rgbcct_bulb/turn_on?`+o,{method:"POST"}),console.log("Light state:",this)}catch(n){console.error("Failed to update light state:",n)}};let $=X,l;const P={slider:document.getElementById("brightness-slider"),label:document.getElementById("brightness-label")},T={slider:document.getElementById("temperature-slider"),label:document.getElementById("temperature-label")},q=document.getElementById("power-button");P.slider.disabled=!0;T.slider.disabled=!0;q.disabled=!0;const v=document.getElementById("color-wheel"),C=v.getContext("2d"),k=document.getElementById("color-display"),_=300,h=_/2;v.width=v.height=_;v.style.width=v.style.height=_+"px";let S=null,V=null;function H(e,t,o){let n=(e*180/Math.PI%360+360)%360,r=t,i=o,c=i*r,m=c*(1-Math.abs(n/60%2-1)),E=i-c,p,b,u;n<60?(p=c,b=m,u=0):n<120?(p=m,b=c,u=0):n<180?(p=0,b=c,u=m):n<240?(p=0,b=m,u=c):n<300?(p=m,b=0,u=c):(p=c,b=0,u=m);const N=p+E,O=b+E,U=u+E;return{r:N,g:O,b:U}}function tt(){const e=C.getImageData(0,0,_,_),t=e.data;for(let o=0;o<_;o++)for(let n=0;n<_;n++){const r=n-h,i=o-h,c=Math.sqrt(r*r+i*i);if(c<=h){const m=Math.atan2(i,r),{r:E,g:p,b}=H(m,c/h,V),u=(o*_+n)*4;t[u]=E*255,t[u+1]=p*255,t[u+2]=b*255,t[u+3]=255}}C.putImageData(e,0,0)}function R(e=!1){P.slider.disabled=!l.state,P.slider.value=l.brightness,P.label.textContent=(l.brightness*100).toFixed(2),T.slider.disabled=!l.state,T.slider.value=1-(l.color_temp-l.min_color_temp)/(l.max_color_temp-l.min_color_temp),T.label.textContent=(1e6/l.color_temp).toFixed(2)+"K",q.textContent=l.state?"Turn Off":"Turn On";const t=l.state;(S!==t||S&&V!==l.brightness)&&(S=t,V=l.brightness,C.clearRect(0,0,_,_),S?(v.style.pointerEvents="auto",tt()):(C.fillStyle="rgba(100, 100, 100, 0.5)",C.beginPath(),C.arc(h,h,h,0,2*Math.PI),C.fill())),e||l.debounce()}P.slider.addEventListener("input",()=>{l.brightness=P.slider.value,R()});T.slider.addEventListener("input",()=>{l.color_temp=l.min_color_temp+(1-T.slider.value)*(l.max_color_temp-l.min_color_temp),R()});q.addEventListener("click",()=>{l.state=!l.state,R()});v.addEventListener("touchdown",e=>{{const r=v.getBoundingClientRect();let i=e.clientX-r.left-h,c=e.clientY-r.top-h;if(Math.sqrt(i*i+c*c)>h)return}const t=r=>{const i=v.getBoundingClientRect();let c=r.clientX-i.left-h,m=r.clientY-i.top-h;const E=Math.min(Math.sqrt(c*c+m*m),h),p=Math.atan2(m,c),{r:b,g:u,b:N}=H(p,E/h,1),O=[b,u,N],U=`RGB: (${O.map(K=>K.toFixed(2)).join(", ")})`;k.textContent=U,l.setColor(O[0],O[1],O[2]),R()},o=r=>{r.preventDefault(),t(r)},n=()=>{document.removeEventListener("touchmove",o),document.removeEventListener("touchup",n)};document.addEventListener("touchmove",o,{passive:!1}),document.addEventListener("touchup",n),t(e)});$.fetch().then(e=>{l=e,q.disabled=!1,R(!0)});
